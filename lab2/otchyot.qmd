---
title: "Сбор и аналитическая обработка информации о сетевом трафике"
author: "Сафрыгина Анастасия"
engine: knitr
format:
    md:
        output-file: "README.md"
---

## Цель работы

1.Развить практические навыки использования современного стека инструментов сбора и аналитической обработки информации о сетевом трафике

2.Освоить базовые подходы блокировки нежелательного сетевого трафика

3.Закрепить знания о современных сетевых протоколах прикладного уровня

## План

1.Получить трафик

2.Перевод трафика в метаинформацию

3.Анализ трафика

4.Определение нежелательного трафика

## Шаги

1.С помощью Wireshark было захвачено 108 МБ трафика:

![](1.png)

2.С помощью утилиты zeek была получена метаинформация о трафике (см. файл dns.log в репозитории)

```{bash}
/opt/zeek/bin/zeek -C -r /home/soplyashka/laba2.pcapng
```
3.Для анализа трафика необходимо получить список нежелательных доменов.

```{bash}
curl https://winhelp2002.mvps.org/hosts.txt -o hosts
```

С помощью Python подготовим файл для анализа:

```{python}
bad_hosts = []
with open('host1.txt') as file:
    for line in file.readlines()[27:]:
        if line[0] == '#':
            continue
        bad_hosts.append(line.split()[1])
```

Преобразуем полученную метаинформацию в пригодный к анализу вид:

```{python}
hosts = []
with open('dns.log') as file:
    for line in file.readlines():
        if line[0] == '#':
            continue
        try:
            hosts.append(line.split()[9])
        except IndexError:
            continue
```

4.Проанализируем полученный трафик:

```{python}
bad_count = len([host for host in hosts if host in bad_hosts])
percentile = round(bad_count/len(hosts),3)*100
print("Число вхождений DNS в список нежелательного трафика: {}.".format(str(bad_count)),
"Процент нежелательного трафика: {}%.".format(str(percentile)),sep='\n')
```

## Оценка результата

В результате лабораторной работы мы смогли определить нежелательный трафик.

## Вывод

Таким образом, мы научились анализировать сетевой трафик и, используя современный стек инструментов, был освоен подход блокировки нежелательного сетевого трафика на основе чёрного списка.
